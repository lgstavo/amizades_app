import{r as i,j as R,c as a,a as o,b as m,e as A,t as l,n as g,F as f,k as h,i as c,h as S,o as n}from"./index-DToKaazj.js";const U={class:"container"},$={class:"nav-buttons"},E={key:0,class:"loading-message"},I={key:1,class:"error-message"},B={key:2},L={key:0},x={class:"item-name"},D=["onClick"],F={key:1,class:"empty-message"},T={key:3},j={key:0},P={class:"item-name"},H=["onClick"],M=["onClick"],O={key:1,class:"empty-message"},G={key:4},J={key:0},K={class:"item-name"},Q={key:1,class:"empty-message"},Y={__name:"DashboardView",setup(W){const V=S(),_=i(""),r=i("users"),d=i([]),p=i([]),u=i([]),y=i({initial:!0}),v=i(null);async function w(){try{const s=await c.get("/api/users");d.value=s.data}catch(s){console.error("Erro ao buscar usuários: ",s),v.value="Não foi possível carregar a lista de usuários."}}async function N(){try{const s=await c.get("/api/friend-requests/received");u.value=s.data}catch(s){console.error("Erro ao buscar solicitações:",s),v.value="Não foi possível carregar as solicitações de amizade."}}async function k(){try{const s=await c.get("/api/friend-requests/friends");p.value=s.data}catch(s){console.error("Erro ao buscar amigos:",s),v.value="Não foi possível carregar a lista de amigos."}}async function z(s){try{await c.post("/api/friend-requests",{toUserId:s}),alert("Pedido de amizade enviado!"),d.value=d.value.filter(e=>e.id!==s)}catch(e){console.error("Erro ao enviar pedido:",e),alert(e.response?.data||"Não foi possível enviar o pedido. Talvez já exista um.")}}async function b(s,e){try{await c.post("/api/friend-requests/respond",{requestId:s,status:e}),alert(`Pedido ${e==="aceita"?"aceito":"recusado"} com sucesso!`),u.value=u.value.filter(t=>t.requestId!==s),e==="aceita"&&await k()}catch(t){console.error("Erro ao responder pedido:",t),alert("Não foi possível responder ao pedido.")}}const C=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("username"),delete c.defaults.headers.common.Authorization,V.push("/login")};return R(async()=>{console.log("DASHBOARD: Componente montado, buscando todos os dados...");const s=localStorage.getItem("username");if(s)_.value=s;else{C();return}await Promise.all([w(),N(),k()]),y.value.initial=!1}),(s,e)=>(n(),a("div",null,[o("div",U,[o("header",null,[o("h2",null,[e[3]||(e[3]=A("Bem-vindo, ")),o("span",null,l(_.value),1),e[4]||(e[4]=A("!"))]),o("div",$,[o("button",{onClick:e[0]||(e[0]=t=>r.value="users"),class:g({active:r.value==="users"})},"Ver Usuários",2),o("button",{onClick:e[1]||(e[1]=t=>r.value="requests"),class:g({active:r.value==="requests"})}," Ver Solicitações ("+l(u.value.length)+") ",3),o("button",{onClick:e[2]||(e[2]=t=>r.value="friends"),class:g({active:r.value==="friends"})}," Ver Amigos ("+l(p.value.length)+") ",3),o("button",{onClick:C,class:"logout-button"},"Logout")])]),y.value.initial?(n(),a("div",E,"Carregando dados do dashboard...")):m("",!0),v.value?(n(),a("div",I,l(v.value),1)):m("",!0),r.value==="users"?(n(),a("section",B,[e[5]||(e[5]=o("h3",null,"Usuários para Adicionar",-1)),d.value.length>0?(n(),a("ul",L,[(n(!0),a(f,null,h(d.value,t=>(n(),a("li",{key:t.id,class:"list-item"},[o("span",x,l(t.username),1),o("button",{onClick:q=>z(t.id),class:"action-button add-button"},"Adicionar Amigo",8,D)]))),128))])):(n(),a("p",F,"Não há novos usuários para adicionar no momento."))])):m("",!0),r.value==="requests"?(n(),a("section",T,[e[6]||(e[6]=o("h3",null,"Solicitações de Amizade Recebidas",-1)),u.value.length>0?(n(),a("ul",j,[(n(!0),a(f,null,h(u.value,t=>(n(),a("li",{key:t.requestId,class:"list-item"},[o("span",P,l(t.fromUsername),1),o("div",null,[o("button",{onClick:q=>b(t.requestId,"aceita"),class:"action-button accept-button"},"Aceitar",8,H),o("button",{onClick:q=>b(t.requestId,"recusada"),class:"action-button reject-button"},"Recusar",8,M)])]))),128))])):(n(),a("p",O,"Você não tem nenhuma solicitação de amizade pendente."))])):m("",!0),r.value==="friends"?(n(),a("section",G,[e[7]||(e[7]=o("h3",null,"Amigos",-1)),p.value.length>0?(n(),a("ul",J,[(n(!0),a(f,null,h(p.value,t=>(n(),a("li",{key:t.id,class:"list-item"},[o("span",K,l(t.username),1)]))),128))])):(n(),a("p",Q,"Você ainda não tem amigos."))])):m("",!0)])]))}};export{Y as default};
